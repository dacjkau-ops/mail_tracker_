---
phase: 05-mail-detail-ui-ux-refresh
plan: 02
type: execute
wave: 2
depends_on:
  - 05-01
files_modified:
  - frontend/src/pages/MailDetailPage.jsx
autonomous: false
requirements:
  - UIUX-04
  - UIUX-05
  - UIUX-06
  - UIUX-07
  - UIUX-08
  - UIUX-09
  - UIUX-10
  - UIUX-11
  - UIUX-12
  - UIUX-13

must_haves:
  truths:
    - "Mail Detail body uses a two-column layout: 65% left / 35% right"
    - "Left column shows three MUI Cards: Origin (From Office, Date Received, Letter No), Instructions (action_required), and Handler Remarks (current_action_remarks with 'No remarks yet' placeholder when empty)"
    - "Right column shows Current Handler card with handler name and time-in-stage, Due Date with red highlight when overdue and not Closed, and action buttons"
    - "Action buttons (Reassign, Close, Reopen, Assign to Multiple) are only shown when the user has permission — no greyed-out buttons"
    - "Handler Remarks card supports inline editing: clicking an edit icon enters edit mode showing a TextField; Save and Cancel buttons save/discard changes via the existing updateCurrentAction API"
    - "Audit trail is rendered as a vertical MUI Timeline (from @mui/lab) with entries sorted newest-first"
    - "Each timeline entry shows relative timestamp ('3 days ago') prominently with absolute datetime below, action type, actor name, and remarks (always fully visible)"
    - "Fields with null or empty values are hidden (not shown as blank or N/A) — except Handler Remarks which always renders"
  artifacts:
    - path: "frontend/src/pages/MailDetailPage.jsx"
      provides: "Complete redesigned Mail Detail page with two-column layout, cards, inline remarks editing, and MUI Timeline audit trail"
      min_lines: 200
  key_links:
    - from: "frontend/src/pages/MailDetailPage.jsx"
      to: "@mui/lab"
      via: "import Timeline, TimelineItem, etc."
      pattern: "from '@mui/lab'"
    - from: "MailDetailPage (Handler Remarks card)"
      to: "mailService.updateCurrentAction"
      via: "inline save handler calling updateCurrentAction with current_action_remarks"
      pattern: "updateCurrentAction"
---

<objective>
Redesign the main body of MailDetailPage into a two-column layout with contextual cards, inline remarks editing, and a MUI Timeline audit trail.

Purpose: The current page is a flat list of all fields in a single Paper. The redesign gives information clear hierarchy: left column holds the content the reader needs to understand the mail (origin, instructions, what the handler is doing); right column holds the current state and the actions the reader can take.

Output: A fully redesigned MailDetailPage body replacing the "Mail Information" Paper, "Initial Instructions" Paper, "PDF Attachment" Paper, "Action Buttons" Paper, "AssignmentsPanel", and "Audit Trail" List with the new two-column card layout and Timeline.
</objective>

<execution_context>
@C:/Users/vaish/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/vaish/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@frontend/src/pages/MailDetailPage.jsx
@frontend/src/utils/constants.js
@frontend/src/utils/dateHelpers.js
@.planning/phases/05-mail-detail-ui-ux-refresh/05-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Build two-column layout with Origin, Instructions, and Handler Remarks cards (left) and Current Handler + Due Date + Actions (right)</name>
  <files>frontend/src/pages/MailDetailPage.jsx</files>
  <action>
Replace everything in the JSX return AFTER the header Paper block (after the pdfUploadWarning Alert and the new redesigned header from plan 01) with the new two-column body layout. The dialogs at the bottom (ReassignDialog, CloseMailDialog, ReopenDialog, MultiAssignDialog, UpdateCurrentActionDialog) are kept as-is since they are still used.

**State to add** for inline remarks editing:
```jsx
const [remarksEditing, setRemarksEditing] = useState(false);
const [remarksValue, setRemarksValue] = useState('');
const [remarksSaving, setRemarksSaving] = useState(false);
```

**Handler for inline remarks save:**
```jsx
const handleSaveRemarks = async () => {
  setRemarksSaving(true);
  try {
    await mailService.updateCurrentAction(id, {
      current_action_status: mail.current_action_status || 'Under Review',
      current_action_remarks: remarksValue.trim(),
    });
    setRemarksEditing(false);
    loadMail();
    loadAuditTrail();
  } catch (err) {
    console.error('Failed to save remarks:', err);
  } finally {
    setRemarksSaving(false);
  }
};
```

**Update imports** — add to MUI icons: `Edit as EditIcon` (already present), `Save as SaveIcon`, `Cancel as CancelIcon` from '@mui/icons-material'. Add `TextField, IconButton` to MUI imports if not already present.

**Replace body JSX** (everything between the header Paper close tag and the dialogs section):

```jsx
{/* Two-column layout */}
<Grid container spacing={3} alignItems="flex-start">

  {/* LEFT COLUMN — 65% */}
  <Grid item xs={12} md={8}>

    {/* Origin Card */}
    <Card sx={{ mb: 2, borderRadius: 2 }} elevation={1}>
      <CardContent>
        <Typography variant="overline" color="text.secondary" sx={{ letterSpacing: 1 }}>
          Origin
        </Typography>
        <Divider sx={{ my: 1 }} />
        {/* From Office — always show if present */}
        {mail.from_office && (
          <Box mb={1.5}>
            <Typography variant="caption" color="text.secondary">From Office</Typography>
            <Typography variant="body1">{mail.from_office}</Typography>
          </Box>
        )}
        {/* Date Received — always show if present */}
        {mail.date_received && (
          <Box mb={1.5}>
            <Typography variant="caption" color="text.secondary">Date Received</Typography>
            <Typography variant="body1">{formatDate(mail.date_received)}</Typography>
          </Box>
        )}
        {/* Letter No — always show if present */}
        {mail.letter_no && (
          <Box mb={1.5}>
            <Typography variant="caption" color="text.secondary">Letter No</Typography>
            <Typography variant="body1">{mail.letter_no}</Typography>
          </Box>
        )}
      </CardContent>
    </Card>

    {/* Instructions Card — only render if action_required is non-empty */}
    {mail.action_required && (
      <Card sx={{ mb: 2, borderRadius: 2 }} elevation={1}>
        <CardContent>
          <Typography variant="overline" color="text.secondary" sx={{ letterSpacing: 1 }}>
            Instructions
          </Typography>
          <Divider sx={{ my: 1 }} />
          <Typography variant="body1" sx={{ whiteSpace: 'pre-wrap' }}>
            {mail.action_required}
          </Typography>
        </CardContent>
      </Card>
    )}

    {/* Handler Remarks Card — ALWAYS rendered (most important field) */}
    <Card
      sx={{
        mb: 2,
        borderRadius: 2,
        border: '2px solid',
        borderColor: 'primary.light',
      }}
      elevation={2}
    >
      <CardContent>
        <Box display="flex" justifyContent="space-between" alignItems="center">
          <Typography variant="overline" color="primary" sx={{ letterSpacing: 1, fontWeight: 700 }}>
            Handler Remarks
          </Typography>
          {canEditRemarks() && mail.status !== 'Closed' && !remarksEditing && (
            <IconButton
              size="small"
              onClick={() => {
                setRemarksValue(mail.current_action_remarks || '');
                setRemarksEditing(true);
              }}
              title="Edit remarks"
            >
              <EditIcon fontSize="small" />
            </IconButton>
          )}
        </Box>
        <Divider sx={{ my: 1 }} />
        {remarksEditing ? (
          <Box>
            <TextField
              fullWidth
              multiline
              minRows={3}
              value={remarksValue}
              onChange={(e) => setRemarksValue(e.target.value)}
              placeholder="What are you doing with this mail? What's the current status?"
              variant="outlined"
              size="small"
              autoFocus
            />
            <Box display="flex" gap={1} mt={1} justifyContent="flex-end">
              <Button
                size="small"
                startIcon={<CancelIcon />}
                onClick={() => setRemarksEditing(false)}
                disabled={remarksSaving}
              >
                Cancel
              </Button>
              <Button
                size="small"
                variant="contained"
                startIcon={<SaveIcon />}
                onClick={handleSaveRemarks}
                disabled={remarksSaving}
              >
                {remarksSaving ? 'Saving...' : 'Save'}
              </Button>
            </Box>
          </Box>
        ) : (
          <Typography
            variant="body1"
            sx={{
              whiteSpace: 'pre-wrap',
              color: mail.current_action_remarks ? 'text.primary' : 'text.secondary',
              fontStyle: mail.current_action_remarks ? 'normal' : 'italic',
            }}
          >
            {mail.current_action_remarks || 'No remarks yet'}
          </Typography>
        )}
      </CardContent>
    </Card>

    {/* PDF Attachment — only if present */}
    {mail?.attachment_metadata?.has_attachment && (
      <Card sx={{ mb: 2, borderRadius: 2 }} elevation={1}>
        <CardContent>
          <Typography variant="overline" color="text.secondary" sx={{ letterSpacing: 1 }}>
            Attachment
          </Typography>
          <Divider sx={{ my: 1 }} />
          <Box display="flex" alignItems="center" gap={2} flexWrap="wrap">
            <PdfIcon color="error" />
            <Box flex={1}>
              <Typography variant="body2">
                {mail.attachment_metadata.original_filename || 'attachment.pdf'}
              </Typography>
              {(mail.attachment_metadata.file_size_human || mail.attachment_metadata.uploaded_at) && (
                <Typography variant="caption" color="text.secondary">
                  {mail.attachment_metadata.file_size_human || ''}
                  {mail.attachment_metadata.uploaded_at
                    ? ` · Uploaded ${formatDateTime(mail.attachment_metadata.uploaded_at)}`
                    : ''}
                </Typography>
              )}
            </Box>
            <Button variant="outlined" size="small" onClick={handleViewPdf}>View</Button>
            <Button variant="outlined" size="small" onClick={handleDownloadPdf}>Download</Button>
          </Box>
        </CardContent>
      </Card>
    )}

  </Grid>

  {/* RIGHT COLUMN — 35% */}
  <Grid item xs={12} md={4}>

    {/* Action Buttons — shown only when user has permission */}
    {(canReassignMail() || canCloseMail() || canReopenMail() || canMultiAssign()) && (
      <Card sx={{ mb: 2, borderRadius: 2 }} elevation={1}>
        <CardContent>
          <Typography variant="overline" color="text.secondary" sx={{ letterSpacing: 1 }}>
            Actions
          </Typography>
          <Divider sx={{ my: 1 }} />
          <Box display="flex" flexDirection="column" gap={1}>
            {canReassignMail() && (
              <Button
                variant="outlined"
                startIcon={<ReassignIcon />}
                onClick={() => setReassignDialogOpen(true)}
                fullWidth
              >
                Reassign
              </Button>
            )}
            {canCloseMail() && (
              <Button
                variant="contained"
                color="success"
                startIcon={<CloseIcon />}
                onClick={() => setCloseDialogOpen(true)}
                fullWidth
              >
                Close Mail
              </Button>
            )}
            {canReopenMail() && (
              <Button
                variant="outlined"
                color="warning"
                startIcon={<ReopenIcon />}
                onClick={() => setReopenDialogOpen(true)}
                fullWidth
              >
                Reopen
              </Button>
            )}
            {canMultiAssign() && (
              <Button
                variant="outlined"
                color="secondary"
                startIcon={<MultiAssignIcon />}
                onClick={() => setMultiAssignDialogOpen(true)}
                fullWidth
              >
                Assign to Multiple
              </Button>
            )}
          </Box>
        </CardContent>
      </Card>
    )}

    {/* Current Handler Card */}
    <Card sx={{ mb: 2, borderRadius: 2 }} elevation={1}>
      <CardContent>
        <Typography variant="overline" color="text.secondary" sx={{ letterSpacing: 1 }}>
          Current Handler
        </Typography>
        <Divider sx={{ my: 1 }} />
        {mail.is_multi_assigned && mail.current_handlers_display?.length > 0 ? (
          <Box sx={{ display: 'flex', gap: 0.5, flexWrap: 'wrap' }}>
            {mail.current_handlers_display.map((name, idx) => (
              <Chip key={`${name}-${idx}`} label={name} color="primary" size="small" variant="outlined" />
            ))}
          </Box>
        ) : (
          mail.current_handler_details?.full_name && (
            <Typography variant="body1" fontWeight={600}>
              {mail.current_handler_details.full_name}
            </Typography>
          )
        )}
        {/* Time in current stage */}
        <Typography variant="caption" color="text.secondary" sx={{ display: 'block', mt: 1 }}>
          In stage for {calculateTimeInStage(mail.last_status_change, mail.date_of_completion)}
        </Typography>
      </CardContent>
    </Card>

    {/* Due Date Card */}
    {mail.due_date && (
      <Card sx={{ mb: 2, borderRadius: 2 }} elevation={1}>
        <CardContent>
          <Typography variant="overline" color="text.secondary" sx={{ letterSpacing: 1 }}>
            Due Date
          </Typography>
          <Divider sx={{ my: 1 }} />
          <Typography
            variant="h6"
            fontWeight={700}
            color={overdue ? 'error' : 'text.primary'}
          >
            {formatDate(mail.due_date)}
          </Typography>
          {overdue && (
            <Typography variant="caption" color="error">
              Overdue
            </Typography>
          )}
        </CardContent>
      </Card>
    )}

  </Grid>

</Grid>
```

**After the two-column Grid, add the Assignments Panel and the Audit Trail Timeline** (both full-width, below):

For the AssignmentsPanel, keep it as-is:
```jsx
<AssignmentsPanel
  mailId={id}
  onUpdate={() => { loadMail(); loadAuditTrail(); }}
  mailData={mail}
/>
```

The Timeline is added in Task 2.

**Important implementation notes:**
- The `UpdateCurrentActionDialog` is no longer triggered from the action buttons area (the "Update Current Action" button is removed). Inline editing replaces it. However, keep the `updateActionDialogOpen` state and `UpdateCurrentActionDialog` at the bottom of the return for now if removing it causes issues — or remove the state and dialog entirely since inline editing replaces it entirely.
- Remove the old "Mail Information" Paper, "Initial Instructions" Paper, and "PDF Attachment" Paper sections.
- Remove the old "Actions" Paper that had the flat button row.
- The existing dialog components (ReassignDialog, CloseMailDialog, ReopenDialog, MultiAssignDialog, UpdateCurrentActionDialog) are still imported and rendered at the bottom.
- `Grid` is already imported. `TextField`, `IconButton` must be added to MUI imports if not present.
- Add `SaveIcon` (`Save`) and `CancelIcon` (`Cancel`) to @mui/icons-material imports.
- The `md={8}` / `md={4}` Grid sizing implements the 65%/35% two-column layout (8+4 = 12 MUI grid units).
  </action>
  <verify>
1. Run `npm run build` from frontend/ — must complete with no errors.
2. Open a mail detail page in the browser — verify two-column layout renders.
3. Confirm Origin card shows From Office, Date Received, Letter No (no Section field).
4. Confirm Handler Remarks card always renders, shows "No remarks yet" when empty.
5. Confirm current handler is visible in right column with time-in-stage.
6. Confirm action buttons appear in right column only for permitted actions.
7. Confirm no "N/A" text appears anywhere on the page for missing fields.
  </verify>
  <done>Two-column layout renders correctly with left cards (Origin, Instructions, Handler Remarks) and right column (Actions, Current Handler, Due Date). Inline remarks editing works. No N/A placeholders visible.</done>
</task>

<task type="auto">
  <name>Task 2: Replace audit trail list with MUI Timeline</name>
  <files>frontend/src/pages/MailDetailPage.jsx</files>
  <action>
Replace the existing audit trail `<Paper>` block (which uses `<List>` / `<ListItem>`) with a full-width Paper containing a vertical MUI Timeline from @mui/lab.

**Add to imports at top of MailDetailPage.jsx:**
```jsx
import {
  Timeline,
  TimelineItem,
  TimelineSeparator,
  TimelineConnector,
  TimelineContent,
  TimelineDot,
  TimelineOppositeContent,
} from '@mui/lab';
```

**Audit trail sort order (locked decision):** Sort entries newest-first. The `auditTrail` array from the API may be oldest-first. Sort before rendering:
```jsx
const sortedAuditTrail = [...auditTrail].sort(
  (a, b) => new Date(b.timestamp) - new Date(a.timestamp)
);
```
Define this inside the component just before the return statement (after the `overdue` variable).

**Action type to icon mapping** (define as a constant outside the component or as a local const in render):
- CREATE → `<TimelineDot color="primary" />`
- ASSIGN → `<TimelineDot color="info" />`
- REASSIGN → `<TimelineDot color="warning" />`
- UPDATE → `<TimelineDot color="secondary" />`
- CLOSE → `<TimelineDot color="success" />`
- REOPEN → `<TimelineDot color="warning" />`
- MULTI_ASSIGN → `<TimelineDot color="info" />`
- default → `<TimelineDot />`

**Timeline JSX** (replaces the existing Audit Trail Paper block, placed after AssignmentsPanel):

```jsx
<Paper sx={{ p: 3, mt: 3 }}>
  <Typography variant="h6" gutterBottom>
    {mail.is_multi_assigned ? 'Global Activity Log' : 'Audit Trail'}
  </Typography>
  {mail.is_multi_assigned && (
    <Typography variant="body2" color="text.secondary" sx={{ mb: 1 }}>
      For detailed per-assignee history, see the Assignments Overview above.
    </Typography>
  )}
  <Divider sx={{ mb: 2 }} />

  {sortedAuditTrail.length === 0 ? (
    <Typography variant="body2" color="text.secondary">
      No audit trail available
    </Typography>
  ) : (
    <Timeline
      sx={{
        p: 0,
        [`& .MuiTimelineItem-root::before`]: { flex: 0, padding: 0 },
      }}
    >
      {sortedAuditTrail
        .filter(entry => {
          if (mail.is_multi_assigned) {
            return ['CREATE', 'MULTI_ASSIGN', 'CLOSE', 'REOPEN'].includes(entry.action);
          }
          return true;
        })
        .map((entry, index, arr) => (
          <TimelineItem key={index}>
            <TimelineSeparator>
              {/* Color-coded dot by action type */}
              {{
                CREATE: <TimelineDot color="primary" />,
                ASSIGN: <TimelineDot color="info" />,
                REASSIGN: <TimelineDot color="warning" />,
                UPDATE: <TimelineDot color="secondary" />,
                CLOSE: <TimelineDot color="success" />,
                REOPEN: <TimelineDot color="warning" />,
                MULTI_ASSIGN: <TimelineDot color="info" />,
              }[entry.action] || <TimelineDot />}
              {index < arr.length - 1 && <TimelineConnector />}
            </TimelineSeparator>
            <TimelineContent sx={{ pb: 3 }}>
              {/* Relative timestamp prominently */}
              <Typography variant="subtitle2" fontWeight={700}>
                {getRelativeTime(entry.timestamp)}
              </Typography>
              {/* Absolute datetime smaller beneath */}
              <Typography variant="caption" color="text.secondary" sx={{ display: 'block', mb: 0.5 }}>
                {formatDateTime(entry.timestamp)}
              </Typography>
              {/* Action type + actor */}
              <Typography variant="body2" color="text.secondary">
                <strong>{entry.action_display || entry.action}</strong>
                {' '}by {entry.performed_by_details?.full_name || 'Unknown'}
              </Typography>
              {/* Remarks — always fully visible when present */}
              {entry.remarks && (
                <Typography
                  variant="body2"
                  sx={{
                    mt: 0.5,
                    p: 1,
                    bgcolor: 'grey.50',
                    borderRadius: 1,
                    borderLeft: '3px solid',
                    borderColor: 'grey.300',
                    fontStyle: 'italic',
                  }}
                >
                  {entry.remarks}
                </Typography>
              )}
            </TimelineContent>
          </TimelineItem>
        ))}
    </Timeline>
  )}
</Paper>
```

**Note on the `sx` override for Timeline:** MUI Timeline by default adds `::before` pseudo-elements that create left-side space. The override `[& .MuiTimelineItem-root::before]: { flex: 0, padding: 0 }` removes this so the timeline aligns to the left without the opposite-content area.

**Import `getRelativeTime`** from `'../utils/dateHelpers'` — it already exists in dateHelpers.js (exported as `getRelativeTime`).

Add `getRelativeTime` to the import line: `import { formatDate, formatDateTime, calculateTimeInStage, isOverdue, getRelativeTime } from '../utils/dateHelpers';`

Remove the `List`, `ListItem`, `ListItemText` imports from '@mui/material' if they are no longer used elsewhere on the page.
  </action>
  <verify>
1. Run `npm run build` from frontend/ — must complete with no errors.
2. Open a mail detail page — scroll to the bottom to see the Timeline.
3. Confirm entries are newest-first.
4. Confirm each entry shows: relative time (bold), absolute datetime (smaller, below), action type + actor, and remarks (when present, always fully visible with no truncation).
5. Confirm the Timeline dots are color-coded by action type.
6. No build errors related to @mui/lab imports.
  </verify>
  <done>Audit trail renders as a vertical MUI Timeline. Entries are sorted newest-first, show relative + absolute timestamp, action type, actor, and remarks. Color-coded dots per action type. No list/table remains.</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 3: Human verification of full Mail Detail redesign</name>
  <what-built>
Complete Mail Detail page redesign:
- Two-column layout (65% left / 35% right)
- Left: Origin card (From Office, Date Received, Letter No), Instructions card (action_required), Handler Remarks card (inline editing, always shown)
- Right: Action buttons (hidden when not permitted), Current Handler + time-in-stage, Due Date (red when overdue)
- MUI Timeline audit trail (newest-first, relative+absolute timestamps, color-coded dots)
- Status chip: Pending/In Progress/Closed grouping
- Overdue banner in header
- Null/empty fields hidden throughout
  </what-built>
  <how-to-verify>
Start the frontend dev server (`npm run dev` in frontend/) and open a mail detail page. Verify:

1. **Header**: Subject appears as the large h5 title. Serial number (sl_no) appears as smaller subtitle below. Status chip shows "Pending" for Received or Assigned mails, "In Progress" for In Progress, "Closed" for Closed.
2. **Overdue banner**: For a mail with a past due date that is not Closed, a red warning banner appears below the header showing "Overdue by X days".
3. **Two-column layout**: Left column is visibly wider (approx 65%) on a laptop-sized screen. Three cards appear: Origin, Instructions (only if action_required is set), and Handler Remarks.
4. **Handler Remarks**: The card always renders. Shows "No remarks yet" in italic when empty. When the current user is the handler and the mail is not Closed, an edit icon appears in the top-right of the card — clicking it turns the text into an editable TextField with Save and Cancel buttons.
5. **Right column**: Actions card appears with only the buttons the user can perform (no greyed-out buttons). Current Handler card shows the handler name and "In stage for X days" text. Due Date card shows the date in red when overdue.
6. **No N/A text**: No field anywhere on the page shows "N/A" or blank label text.
7. **Audit Timeline**: Scroll to the bottom. Timeline entries appear with: a colored dot (color varies by action type), bold relative time ("3 days ago"), smaller absolute datetime below it, action description + actor, and the full remarks text (not truncated). Entries are newest-first.
8. **All dialogs still work**: Clicking Reassign opens the Reassign dialog. Clicking Close Mail opens the Close dialog. Etc.
  </how-to-verify>
  <action>Human verification step — no code changes. Follow the how-to-verify steps above using the frontend dev server.</action>
  <verify>All 8 verification checks pass as described above.</verify>
  <done>Human has confirmed the complete Mail Detail redesign renders correctly: two-column layout, three left cards, right column actions/handler/due date, MUI Timeline audit trail, inline remarks editing, no N/A text, all dialogs still functional.</done>
  <resume-signal>Type "approved" if the redesign looks correct, or describe specific issues to fix.</resume-signal>
</task>

</tasks>

<verification>
1. `npm run build` completes without errors
2. Two-column layout (md={8}/md={4}) renders at correct widths
3. Origin card: From Office, Date Received, Letter No — no Section field
4. Instructions card: only action_required — only rendered when non-empty
5. Handler Remarks card: always rendered, "No remarks yet" placeholder when empty, inline edit works
6. Right column: action buttons hidden when user lacks permission (no greyed-out)
7. Due date in right column is red when overdue and status != Closed
8. MUI Timeline renders with @mui/lab components
9. Timeline entries: newest-first, relative+absolute timestamps, color-coded dots, full remarks visible
10. getRelativeTime imported and working
11. No N/A placeholders visible on the page
12. All existing dialogs still functional
</verification>

<success_criteria>
- UIUX-04: Two-column layout (65/35) implemented with Grid md={8}/md={4}
- UIUX-05: Origin card with From Office, Date Received, Letter No (no Section)
- UIUX-06: Instructions card with action_required only
- UIUX-07: Handler Remarks card always rendered with "No remarks yet" placeholder
- UIUX-08: Current Handler card in right column with handler name and time-in-stage
- UIUX-09: Due date in right column, red color when overdue and status != Closed
- UIUX-10: Action buttons in right column top area, hidden when user lacks permission
- UIUX-11: Audit trail rendered as vertical MUI Timeline
- UIUX-12: Timeline entries show relative timestamp, absolute datetime, action type, actor, remarks
- UIUX-13: Null/empty fields hidden — no blank labels or N/A text visible
- Human verification checkpoint passed
</success_criteria>

<output>
After completion, create `.planning/phases/05-mail-detail-ui-ux-refresh/05-02-SUMMARY.md`
</output>
