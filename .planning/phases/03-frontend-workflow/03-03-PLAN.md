---
phase: 03-frontend-workflow
plan: 03
type: execute
wave: 2
depends_on:
  - "03-01"
  - "03-02"
files_modified:
  - frontend/src/components/RemarksEditDialog.jsx
  - frontend/src/utils/constants.js
  - backend/records/models.py
  - CLAUDE.md
autonomous: true
requirements:
  - CLEANUP-01
  - CLEANUP-02
  - CLEANUP-03
  - CLEANUP-04
  - CLEANUP-05
  - CLEANUP-06

must_haves:
  truths:
    - "RemarksEditDialog.jsx file is deleted from the repository"
    - "ACTION_REQUIRED_OPTIONS export is removed from constants.js"
    - "backend/records/models.py has exactly one import of django.conf.settings (no duplicate alias)"
    - "CLAUDE.md no longer references the action_required dropdown options list (Review, Approve, Process, File, Reply, Other)"
    - "frontend/dist/ and backend/staticfiles/ are confirmed absent from git tracking (gitignore already covers them)"
    - "backend/sample_data/ files are confirmed tracked in git and left in place (not removed)"
  artifacts:
    - path: "frontend/src/utils/constants.js"
      provides: "Constants file without ACTION_REQUIRED_OPTIONS export"
    - path: "backend/records/models.py"
      provides: "models.py with single settings import"
    - path: "CLAUDE.md"
      provides: "Updated CLAUDE.md reflecting free-text action_required"
  key_links:
    - from: "frontend/src/utils/constants.js"
      to: "ACTION_REQUIRED_OPTIONS"
      via: "export removed; any remaining consumers already removed by Plans 01-02"
      pattern: "ACTION_REQUIRED_OPTIONS"
---

<objective>
Clean up dead code, duplicate imports, and stale documentation left over from the old system. Plans 01 and 02 already removed all consumers of the removed code; this plan deletes the sources.

Purpose: Leave the codebase in a clean state with no unreachable exports, duplicate imports, or docs that contradict the current implementation.
Output: RemarksEditDialog.jsx deleted, ACTION_REQUIRED_OPTIONS removed from constants.js, duplicate settings import fixed in models.py, CLAUDE.md line updated.
</objective>

<execution_context>
@C:/Users/vaish/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/vaish/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@frontend/src/utils/constants.js
@backend/records/models.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Remove dead frontend code and fix backend duplicate import</name>
  <files>
    frontend/src/components/RemarksEditDialog.jsx
    frontend/src/utils/constants.js
    backend/records/models.py
  </files>
  <action>
Step 1 — Delete RemarksEditDialog.jsx:
Run: `rm frontend/src/components/RemarksEditDialog.jsx`
Confirm Plans 01-02 already removed the import and JSX from MailDetailPage.jsx before deleting.

Step 2 — Remove ACTION_REQUIRED_OPTIONS from constants.js:
Read frontend/src/utils/constants.js. Remove the entire ACTION_REQUIRED_OPTIONS array declaration and export (lines 21-28 approximately):
```js
// Action Required Options
export const ACTION_REQUIRED_OPTIONS = [
  'Review',
  'Approve',
  'Process',
  'File',
  'Reply',
  'Other',
];
```
Do NOT remove any other constant. Leave CURRENT_ACTION_STATUS_OPTIONS, ROLES, MAIL_STATUS, AUDIT_ACTIONS, STATUS_COLORS, ACTION_STATUS_COLORS untouched.

Step 3 — Fix duplicate settings import in backend/records/models.py:
Current state (lines 5-6):
```python
from django.conf import settings
from django.conf import settings as django_settings
```
Also there is an inline import at line ~35:
```python
    from django.conf import settings as django_settings
```
Actions:
- Remove line 5: `from django.conf import settings` (the bare import without alias).
- Keep line 6: `from django.conf import settings as django_settings` (the aliased form — this is what get_pdf_storage() uses).
- Remove the inline `from django.conf import settings as django_settings` inside get_pdf_storage() if it exists — it is now redundant.
- Grep the rest of models.py for bare `settings.` references. If any exist, replace with `django_settings.`. If none exist, the removal is clean.

After the change, models.py top-level imports should have exactly one settings import:
`from django.conf import settings as django_settings`

Verify by running: `python -c "import sys; sys.path.insert(0, 'backend'); import django; django.setup()" 2>&1` — but since Django setup requires settings module config, instead verify by running the linter:
`cd backend && python -m py_compile records/models.py && echo OK`
  </action>
  <verify>
Check file does not exist: `ls frontend/src/components/RemarksEditDialog.jsx` — must return "No such file or directory".
Grep 'ACTION_REQUIRED_OPTIONS' in frontend/src/utils/constants.js — must return nothing.
Grep 'from django.conf import settings$' in backend/records/models.py — must return nothing (no bare unaliased import).
Grep 'django_settings' in backend/records/models.py — must return at least one line (the aliased import and usages).
Run: `cd backend && python -m py_compile records/models.py && echo COMPILE_OK`
Run: `cd frontend && npm run build 2>&1 | tail -10` — must still pass.
  </verify>
  <done>
RemarksEditDialog.jsx deleted. ACTION_REQUIRED_OPTIONS export removed from constants.js. backend/records/models.py has single `from django.conf import settings as django_settings` import. py_compile passes. npm run build passes.
  </done>
</task>

<task type="auto">
  <name>Task 2: Update CLAUDE.md and confirm git hygiene</name>
  <files>
    CLAUDE.md
  </files>
  <action>
Step 1 — Update CLAUDE.md line referencing old dropdown:
Find line 289 (approximately):
`- ✅ action_required dropdown shows: Review, Approve, Process, File, Reply, Other`

Replace with:
`- ✅ action_required is a free-text field (max 500 chars); the old dropdown options (Review, Approve, Process, File, Reply, Other) are no longer enforced`

Step 2 — Confirm build artifact gitignore (read-only verification, no file changes):
Run: `git check-ignore -v frontend/dist backend/staticfiles`
Expected output shows both paths are ignored by .gitignore entries `frontend/dist/` and `staticfiles/`.
If they are NOT ignored, add the missing entries to .gitignore. (Per the .gitignore read in planning, they are already there: `frontend/dist/` on line 31 and `staticfiles/` on line 22.)

Step 3 — Confirm sample_data is intentionally tracked:
Run: `git ls-files backend/sample_data/`
Expected: shows README.md, sections_sample.csv, sections_sample.json — leave them. They are reference data, not build artifacts. No action required.

Step 4 — Confirm deprecated fields are NOT removed (CLEANUP-04 is documentation-only):
The `remarks` and `user_remarks` fields on MailRecord must remain in place. Do NOT touch models.py for these fields. Removing them would require a migration and would break the frontend fallback (`mail.remarks` read in MailDetailPage).
Note in SUMMARY.md that CLEANUP-04 was assessed and fields intentionally retained.
  </action>
  <verify>
Grep 'action_required dropdown shows: Review' in CLAUDE.md — must return nothing.
Grep 'free-text' in CLAUDE.md — must appear in the updated line.
Run: `git check-ignore -v frontend/dist backend/staticfiles` — both must be matched.
Run: `git ls-files backend/sample_data/` — must show the sample data files.
  </verify>
  <done>
CLAUDE.md updated to describe free-text action_required. Build artifact directories confirmed gitignored. sample_data files confirmed tracked and left in place. deprecated remarks fields confirmed retained (no migration needed).
  </done>
</task>

</tasks>

<verification>
1. `ls frontend/src/components/RemarksEditDialog.jsx` returns "No such file or directory".
2. Grep 'ACTION_REQUIRED_OPTIONS' across entire frontend/src/ — returns zero matches.
3. `cd backend && python -m py_compile records/models.py` exits 0.
4. `cd frontend && npm run build` exits 0.
5. Grep 'action_required dropdown shows: Review' in CLAUDE.md — zero matches.
6. `git check-ignore frontend/dist backend/staticfiles` — both matched.
</verification>

<success_criteria>
- RemarksEditDialog.jsx is deleted from repository.
- ACTION_REQUIRED_OPTIONS is removed from constants.js and has zero references across the codebase.
- backend/records/models.py has exactly one settings import (aliased form).
- CLAUDE.md reflects free-text action_required.
- Build artifacts (dist, staticfiles) confirmed gitignored.
- sample_data files retained as-is.
- npm build and py_compile both pass.
</success_criteria>

<output>
After completion, create `.planning/phases/03-frontend-workflow/03-03-SUMMARY.md`
</output>
